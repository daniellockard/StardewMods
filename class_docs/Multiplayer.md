# Multiplayer

**Summary:** Class purpose not automatically determined. Review members for details.

## Public Members
- - public enum PartyWideMessageQueue
- - public enum DisconnectType
- - public static readonly long AllPlayers = 0L;
- - public const byte farmerDelta = 0;
- - public const byte serverIntroduction = 1;
- - public const byte playerIntroduction = 2;
- - public const byte locationIntroduction = 3;
- - public const byte forceEvent = 4;
- - public const byte warpFarmer = 5;
- - public const byte locationDelta = 6;
- - public const byte locationSprites = 7;
- - public const byte characterWarp = 8;
- - public const byte availableFarmhands = 9;
- - public const byte chatMessage = 10;
- - public const byte connectionMessage = 11;
- - public const byte worldDelta = 12;
- - public const byte teamDelta = 13;
- - public const byte newDaySync = 14;
- - public const byte chatInfoMessage = 15;
- - public const byte userNameUpdate = 16;
- - public const byte farmerGainExperience = 17;
- - public const byte serverToClientsMessage = 18;
- - public const byte disconnecting = 19;
- - public const byte sharedAchievement = 20;
- - public const byte globalMessage = 21;
- - public const byte partyWideMail = 22;
- - public const byte forceKick = 23;
- - public const byte removeLocationFromLookup = 24;
- - public const byte farmerKilledMonster = 25;
- - public const byte requestGrandpaReevaluation = 26;
- - public const byte digBuriedNut = 27;
- - public const byte requestPassout = 28;
- - public const byte passout = 29;
- - public const byte startNewDaySync = 30;
- - public const byte readySync = 31;
- - public const byte chestHitSync = 32;
- - public const byte dedicatedServerSync = 33;
- - public const byte compressed = 127;
- - public const byte WARP_FLAG_STRUCTURE = 1;
- - public const byte WARP_FLAG_FORCED = 2;
- - public const byte WARP_FLAG_NEEDS_INFO = 4;
- - public const byte WARP_FLAG_FACE_UP = 8;
- - public const byte WARP_FLAG_FACE_RIGHT = 16;
- - public const byte WARP_FLAG_FACE_DOWN = 32;
- - public const byte WARP_FLAG_FACE_LEFT = 64;
- - public const string chat_token_aOrAn = "aOrAn:";
- - public int defaultInterpolationTicks = 15;
- - public int farmerDeltaBroadcastPeriod = 3;
- - public int locationDeltaBroadcastPeriod = 3;
- - public int worldStateDeltaBroadcastPeriod = 3;
- - public int playerLimit = 4;
- - public static string kicked = "KICKED";
- - public readonly NetLogger logging = new NetLogger();
- - public ulong latestID;
- - public Dictionary<string, CachedMultiplayerMap> cachedMultiplayerMaps = new Dictionary<string, CachedMultiplayerMap>();
- - public const string MSG_START_FESTIVAL_EVENT = "festivalEvent";
- - public const string MSG_END_FESTIVAL = "endFest";
- - public const string MSG_TRAIN_APPROACH = "trainApproach";
- - public static string protocolVersion
- - public virtual int MaxPlayers
- - public Multiplayer()
- - public virtual long getNewID()
- - public virtual bool isDisconnecting(Farmer farmer)
- - public virtual bool isDisconnecting(long uid)
- - public virtual bool isClientBroadcastType(byte messageType)
- - public virtual bool allowSyncDelay()
- - public virtual int interpolationTicks()
- - public virtual IEnumerable<NetFarmerRoot> farmerRoots()
- - public virtual NetFarmerRoot farmerRoot(long id)
- - public virtual void broadcastFarmerDeltas()
- - public void updateRoot<T>(T root) where T : INetRoot
- - public virtual void updateRoots()
- - public virtual void broadcastLocationDeltas()
- - public virtual void broadcastLocationDelta(GameLocation loc)
- - public virtual void broadcastSprites(GameLocation location, TemporaryAnimatedSpriteList sprites)
- - public virtual void broadcastSprites(GameLocation location, params TemporaryAnimatedSprite[] sprites)
- - public virtual void broadcastWorldStateDeltas()
- - public virtual void receiveWorldState(BinaryReader msg)
- - public virtual void requestCharacterWarp(NPC character, GameLocation targetLocation, Vector2 position)
- - public virtual NetRoot<GameLocation> locationRoot(GameLocation location)
- - public virtual void sendPassoutRequest()
- - public virtual void receivePassoutRequest(IncomingMessage msg)
- - public virtual void receivePassout(IncomingMessage msg)
- - public virtual object[] generateForceEventMessage(string eventId, GameLocation location, int tileX, int tileY, bool use_local_farmer, bool notify_when_done)
- - public virtual void broadcastEvent(Event evt, GameLocation location, Vector2 positionBeforeEvent, bool use_local_farmer = true, bool notify_when_done = false)
- - public virtual void broadcastRemoveLocationFromLookup(GameLocation location)
- - public virtual void broadcastNutDig(GameLocation location, Point point)
- - public virtual void broadcastPartyWideMail(string mail_key, PartyWideMessageQueue message_queue = PartyWideMessageQueue.MailForTomorrow, bool no_letter = false)
- - public virtual void broadcastGrandpaReevaluation()
- - public virtual void broadcastGlobalMessage(string translationKey, bool onlyShowIfEmpty = false, GameLocation location = null, params string[] substitutions)
- - public virtual NetRoot<T> readObjectFull<T>(BinaryReader reader) where T : class, INetObject<INetSerializable>
- - public virtual void writeObjectFull<T>(BinaryWriter writer, NetRoot<T> root, long? peer) where T : class, INetObject<INetSerializable>
- - public virtual byte[] writeObjectFullBytes<T>(NetRoot<T> root, long? peer) where T : class, INetObject<INetSerializable>
- - public virtual void readObjectDelta<T>(BinaryReader reader, NetRoot<T> root) where T : class, INetObject<INetSerializable>
- - public virtual void writeObjectDelta<T>(BinaryWriter writer, NetRoot<T> root) where T : class, INetObject<INetSerializable>
- - public virtual byte[] writeObjectDeltaBytes<T>(NetRoot<T> root) where T : class, INetObject<INetSerializable>
- - public virtual NetFarmerRoot readFarmer(BinaryReader reader)
- - public virtual void addPlayer(NetFarmerRoot f)
- - public virtual void receivePlayerIntroduction(BinaryReader reader)
- - public virtual void broadcastPlayerIntroduction(NetFarmerRoot farmerRoot)
- - public virtual void broadcastUserName(long farmerId, string userName)
- - public virtual string getUserName(long id)
- - public virtual void playerDisconnected(long id)
- - public virtual void sendFarmhand()
- - public virtual void saveFarmhands()
- - public virtual void clientRemotelyDisconnected(DisconnectType disconnectType)
- - public static bool ShouldLogDisconnect(DisconnectType disconnectType)
- - public static bool IsTimeout(DisconnectType disconnectType)
- - public static void LogDisconnect(DisconnectType disconnectType)
- - public virtual void sendSharedAchievementMessage(int achievement)
- - public virtual void sendServerToClientsMessage(string message)
- - public virtual void sendChatMessage(LocalizedContentManager.LanguageCode language, string message, long recipientID)
- - public virtual void receiveChatMessage(Farmer sourceFarmer, long recipientID, LocalizedContentManager.LanguageCode language, string message)
- - public virtual void globalChatInfoMessage(string messageKey, params string[] args)
- - public void globalChatInfoMessageEvenInSinglePlayer(string messageKey, params string[] args)
- - public virtual void parseServerToClientsMessage(string message)
- - public virtual IEnumerable<GameLocation> activeLocations()
- - public virtual bool isAlwaysActiveLocation(GameLocation location)
- - public virtual bool isActiveLocation(GameLocation location)
- - public virtual void readSprites(BinaryReader reader, GameLocation location, Action<TemporaryAnimatedSprite> assignSprite)
- - public virtual void processIncomingMessage(IncomingMessage msg)
- - public virtual void StartLocalMultiplayerServer()
- - public virtual void StartServer()
- - public virtual void Disconnect(DisconnectType disconnectType)
- - public void UpdateLoading()
- - public virtual void UpdateEarly()
- - public virtual void UpdateLate(bool forceSync = false)
- - public virtual void inviteAccepted()
- - public virtual Client InitClient(Client client)
- - public virtual Server InitServer(Server server)

## Private Members
- - private void returnToMainMenu()

## Protected Members
- - protected List<long> disconnectingFarmers = new List<long>();
- - protected HashSet<GameLocation> _updatedRoots = new HashSet<GameLocation>();
- - protected virtual void broadcastTeamDelta(byte[] delta)
- - protected virtual void broadcastFarmerDelta(Farmer farmer, byte[] delta)
- - protected virtual void broadcastLocationBytes(GameLocation loc, byte messageType, byte[] bytes)
- - protected virtual void broadcastLocationMessage(GameLocation loc, OutgoingMessage message)
- - protected virtual void _receivePassoutRequest(Farmer farmer)
- - protected virtual void receiveRequestGrandpaReevaluation(IncomingMessage msg)
- - protected virtual void receiveFarmerKilledMonster(IncomingMessage msg)
- - protected virtual void receiveNutDig(IncomingMessage msg)
- - protected virtual void _performNutDig(GameLocation location, Point point)
- - protected virtual BinaryWriter createWriter(Stream stream)
- - protected virtual void removeDisconnectedFarmers()
- - protected virtual void saveFarmhand(NetFarmerRoot farmhand)
- - protected virtual void sendChatInfoMessage(string messageKey, params string[] args)
- - protected virtual void receiveChatInfoMessage(Farmer sourceFarmer, string messageKey, string[] args)
- - protected virtual IEnumerable<GameLocation> _GetActiveLocationsHere(GameLocation location)
- - protected virtual void readActiveLocation(IncomingMessage msg)
- - protected virtual GameLocation readLocation(BinaryReader reader)
- - protected virtual LocationRequest readLocationRequest(BinaryReader reader)
- - protected virtual NPC readNPC(BinaryReader reader)
- - protected virtual void receiveTeamDelta(BinaryReader msg)
- - protected virtual void receiveNewDaySync(IncomingMessage msg)
- - protected virtual void receiveFarmerGainExperience(IncomingMessage msg)
- - protected virtual void receiveSharedAchievement(IncomingMessage msg)
- - protected virtual void receiveRemoveLocationFromLookup(IncomingMessage msg)
- - protected virtual void receivePartyWideMail(IncomingMessage msg)
- - protected void _performPartyWideMail(string mail_key, PartyWideMessageQueue message_queue, bool no_letter)
- - protected void receiveForceKick()
- - protected virtual void receiveGlobalMessage(IncomingMessage msg)
- - protected void receiveStartNewDaySync()
- - protected void receiveReadySync(IncomingMessage msg)
- - protected void receiveChestHitSync(IncomingMessage msg)
- - protected void receiveDedicatedServerSync(IncomingMessage msg)
- - protected virtual void updatePendingConnections()

## Internal Members
- - internal static string protocolVersionOverride;

## Other Members
- *(None)*
